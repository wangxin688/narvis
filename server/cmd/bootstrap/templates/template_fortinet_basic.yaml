zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 1877cc163d5b46e1a8121d91b1dbe38e
      name: Templates/narvis
  templates:
    - uuid: fe12276a56084eceab8cb3e41cb426e6
      template: template_fortinet_basic
      name: template_fortinet_basic
      description: |
        The template for monitoring FortiGate firewall by SNMP.
        
        MIBs used:
        HOST-RESOURCES-MIB
        FORTINET-FORTIGATE-MIB
        FORTINET-CORE-MIB
        SNMPv2-MIB
        IF-MIB
        
        Generated by official Zabbix template tool "Templator"
      templates:
        - name: template_interface_basic
      groups:
        - name: Templates/narvis
      items:
        - uuid: 13a652d2054d40f59c8e3ce6933b9fbc
          name: snmp_walk_ha_members
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.13.2.1.1]'
          key: ha.members.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Used for discovering HA members from FORTINET-FORTIGATE-MIB.'
        - uuid: 9270feec4109447d83d4425ee6ebd1bc
          name: snmp_walk_hardware_sensors
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.4.3.2.1]'
          key: hw.sensor.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Used for discovering hardware sensors from FORTINET-FORTIGATE-MIB.'
        - uuid: 1d90453ef9bd4a54a479936b81d26aa3
          name: icmp_ping
          type: SIMPLE
          key: icmpping
          history: 7d
          trends: '0'
          description: |
            Host accessibility by ICMP.
            0 - ICMP ping failed.
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          triggers:
            - uuid: 04b156395c454595aa79755795b72d65
              expression: 'max(/template_fortinet_basic/icmpping,#3)=0'
              name: unavailable_by_icmp_ping
              priority: HIGH
              description: 'Last three attempts returned timeout. Please check device connectivity.'
              manual_close: 'YES'
        - uuid: c8cb78a7454746caa12f80533d67690b
          name: icmp_loss
          type: SIMPLE
          key: icmppingloss
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          description: 'Percentage of lost packets.'
          triggers:
            - uuid: 81808b40eeae4a958ac8e93f4914283a
              expression: 'min(/template_fortinet_basic/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/template_fortinet_basic/icmppingloss,5m)<100'
              name: high_icmp_ping_loss
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'ICMP ping loss detected.'
              manual_close: 'YES'
              dependencies:
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_fortinet_basic/icmpping,#3)=0'
        - uuid: 0e4947082d7b4e1487c24be6717b9c38
          name: icmp_response_time
          type: SIMPLE
          key: icmppingsec
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: s
          description: 'ICMP ping response time (in seconds).'
          triggers:
            - uuid: 539f4ffc9f904a34bd44ddb87906bb0e
              expression: 'avg(/template_fortinet_basic/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: high_icmp_ping_response_time
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              manual_close: 'YES'
              dependencies:
                - name: high_icmp_ping_loss
                  expression: 'min(/template_fortinet_basic/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/template_fortinet_basic/icmppingloss,5m)<100'
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_fortinet_basic/icmpping,#3)=0'
        - uuid: e527b64f0dc849d399cfd11165fb5e97
          name: blocked_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.2.1
          key: 'ips.blocked[fgIpsIntrusionsBlocked.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of intrusions blocked per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: cdb8c28724cb4901942af0f1eb05ddb2
          name: detected_anomaly_based_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.9.1
          key: 'ips.detected.anomaly[fgIpsAnomalyDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of intrusions detected as anomalies per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: 7574e4cfa84247bc81ff350fdc63fc74
          name: detected_critical_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.3.1
          key: 'ips.detected.crit[fgIpsCritSevDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of critical severity intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: e59d806adf2e47a6a57239074897c266
          name: detected_high_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.4.1
          key: 'ips.detected.high[fgIpsHighSevDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of high severity intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: d073bea18a6e47f392cf539d7c087d1f
          name: detected_info_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.7.1
          key: 'ips.detected.info[fgIpsInfoSevDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of info severity intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: 6f6a151f8ecf484a850681dc5e0c10a7
          name: detected_low_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.6.1
          key: 'ips.detected.low[fgIpsLowSevDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of low severity intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: 23a53ae9c12d44b0aa176b05decf24d4
          name: detected_medium_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.5.1
          key: 'ips.detected.med[fgIpsMedSevDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of medium severity intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: d27a5fbf78244eadb499a504c020cc79
          name: detected_signature_based_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.8.1
          key: 'ips.detected.sign[fgIpsSignatureDetections.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of intrusions detected by signature per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: c99a757878134bf7957d42522138a003
          name: total_detected_intrusions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.1.1
          key: 'ips.detected.total[fgIpsIntrusionsDetected.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Total number of intrusions detected per second.
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: 492bf713fa3649359a5e20100352bf38
          name: avtive_sessions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.8.0
          key: 'net.ipv4.sessions[fgSysSesCount.0]'
          delay: 3m
          history: 7d
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of active sessions on the device.
        - uuid: ab1215dd1fdf4961816f28767052b486
          name: new_ipv4_sessions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.11.0
          key: 'net.ipv4.sessions[fgSysSesRate1.0]'
          history: 7d
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            The average session setup rate over the past minute
        - uuid: 73c977d7fb664fc092748ce0ef9127c3
          name: new_ipv6_sessions
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.11.0
          key: 'net.ipv6.sessions[fgSysSes6Rate1.0]'
          history: 7d
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            The average ipv6 session setup rate over the past minute
        - uuid: ed6887dd3ef342729902013a2fa21d13
          name: snmp_walk_sd-wan_health-checks
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.4.9.2.1]'
          key: sdwan_health.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Used for discovering SD-WAN health-checks from FORTINET-FORTIGATE-MIB.'
        - uuid: b170523989e94a6fa5e26cfdcbd77636
          name: cpu_utilization
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.3.0
          key: 'system.cpu.util[fgSysCpuUsage.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            CPU utilization in %.
          triggers:
            - uuid: f110d736759646c7b44b90eb39b17685
              expression: 'min(/template_fortinet_basic/system.cpu.util[fgSysCpuUsage.0],5m)>{$CPU.USAGE.HIGH}'
              name: high_cpu_utilization
              event_name: 'FortiGate: High CPU utilization (over {$CPU.USAGE.HIGH}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'The CPU utilization is too high. The system might be slow to respond.'
              manual_close: 'YES'
        - uuid: 0d99a956e7d44d58ba0d93bc94ed74b1
          name: uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.20.0
          key: 'system.uptime[fgSysUpTime.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Time since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
        - uuid: 821f8e3549cf499eb31d21d06325ade4
          name: snmp_walk_virtual_domain
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.3.2.1.1]'
          key: vdom.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Used for discovering virtual domains from FORTINET-FORTIGATE-MIB.'
        - uuid: 09b1537ec0fe4d389bc9e2f51e3b9ede
          name: memory_utilization
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.4.0
          key: 'vm.memory.util[memoryUsedPercentage.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          description: 'Current memory utilization (percentage).'
          triggers:
            - uuid: ba15567eeb944aa3a38adaf2687cb361
              expression: 'min(/template_fortinet_basic/vm.memory.util[memoryUsedPercentage.0],5m)>{$MEMORY.UTIL.HIGH}'
              name: high_memory_utilization
              event_name: 'FortiGate: High memory utilization (>{$MEMORY.UTIL.HIGH}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
              manual_close: 'YES'
        - uuid: 2b483f66fdd344e1ae4edef048db760d
          name: ssl_vpn_state
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.2.3.1.1.1
          key: 'vpn.ssl.state[fgVpnSslState.0]'
          delay: 3m
          history: 7d
          trends: '0'
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Used to determine whether SSL-VPN is enabled on this virtual domain.
          valuemap:
            name: 'Option state'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: afc907c766e54f3f8bec500c90c0a923
          name: active_ipsec_vpn_tunnels
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.1.1.0
          key: 'vpn.tunnel.active[fgVpnTunnelUpCount.0]'
          delay: 3m
          history: 7d
          trends: '0'
          status: DISABLED
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Number of IPsec VPN tunnels with at least one SA.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 2e42373b06d34964815c13f3fe27f553
          name: snmp_walk_vpn_tunnels
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.12.2.2.1.3,1.3.6.1.4.1.12356.101.12.2.2.1.20]'
          key: vpn.tunnel.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Used for discovering VPN tunnels from FORTINET-FORTIGATE-MIB.'
        - uuid: c1c28b67efdb4abb982d1f144db9724f
          name: active_ssl_vpn_users
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.2.3.1.2.1
          key: 'vpn.users.count[fgVpnSslStatsLoginUsers.0]'
          delay: 3m
          history: 7d
          trends: '0'
          status: DISABLED
          description: |
            MIB: FORTINET-FORTIGATE-MIB
            Current number of users logged in through SSL-VPN tunnels in the virtual domain.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: cc7560ea871945a89f08139a96163396
          name: snmp_walk_wireless_ap
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.12356.101.14.4.3.1]'
          key: wireless.ap.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          status: DISABLED
          description: 'Used for discovering wireless access points from FORTINET-FORTIGATE-MIB.'
        - uuid: 89933fa144d04e388487f3ab5372f9b4
          name: snmp_agent_availability
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          delay: 3m
          history: 7d
          trends: '0'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: 'Host availability status'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value == 2) {
                     return 0
                  } else {
                     return value
                  }
                  }
          triggers:
            - uuid: 865bd82da32542cda387e3ef6d5de035
              expression: 'max(/template_fortinet_basic/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: no_snmp_data_collection
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              manual_close: 'YES'
              dependencies:
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_fortinet_basic/icmpping,#3)=0'
      discovery_rules:
        - uuid: 8995260ef28548d4b7266eb808e6b45a
          name: ha_member_discovery
          type: DEPENDENT
          key: ha.discovery
          delay: '0'
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              - macro: '{#HA.SN}'
                value: '{$HA.MEMBER.SN.MATCHES}'
                formulaid: A
              - macro: '{#HA.SN}'
                value: '{$HA.MEMBER.SN.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          description: 'Used for discovering HA members from FORTINET-FORTIGATE-MIB.'
          item_prototypes:
            - uuid: 20cdbfe50c7a4e818fadd25101ca61ec
              name: 'HA {#HA.ID}: Anti-virus events'
              type: DEPENDENT
              key: 'ha.av.events[fgHaStatsAvCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of anti-virus events triggered on the specified cluster member per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 8442462bdf9e48c2a9d06426f41442cb
              name: 'HA {#HA.ID}: Bytes processed'
              type: DEPENDENT
              key: 'ha.bytes.rate[fgHaStatsByteCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: Bps
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of bytes processed by the specified cluster member per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.8.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 2e18e9a1187640069c5bc91d5b0a85dd
              name: 'HA {#HA.ID}: Global checksum'
              type: DEPENDENT
              key: 'ha.checksum.global[fgHaStatsGlobalChecksum.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Current HA global checksum value.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.15.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 419673dd8ac743129e06331a05a765ed
              name: 'HA {#HA.ID}: CPU usage'
              type: DEPENDENT
              key: 'ha.cpu.usage[fgHaStatsCpuUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                CPU usage of the specified cluster member (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.3.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: f11bfb3acd7246f08a0102781cab9351
              name: 'HA {#HA.ID}: Hostname'
              type: DEPENDENT
              key: 'ha.hostname[fgHaStatsHostname.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Host name of the specified cluster member.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.11.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: a58e030e95054f3e9a964d9269ac7f13
              name: 'HA {#HA.ID}: IPS events'
              type: DEPENDENT
              key: 'ha.ips.events[fgHaStatsIdsCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of IDS/IPS events triggered on the specified cluster member per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.9.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 267dfa742071430cacb73bcf32602774
              name: 'HA {#HA.ID}: Memory usage'
              type: DEPENDENT
              key: 'ha.mem.usage[fgHaStatsMemUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Memory usage of the specified cluster member (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.4.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 85e5c80cf5f24c5c99273be323e95178
              name: 'HA {#HA.ID}: Network bandwidth usage'
              type: DEPENDENT
              key: 'ha.net.usage[fgHaStatsNetUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: bps
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Network bandwidth usage of the specified cluster member (bps).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 9f259887a848439ab1430f24a270a486
              name: 'HA {#HA.ID}: Packets processed'
              type: DEPENDENT
              key: 'ha.packets.rate[fgHaStatsPktCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of packets processed by the specified cluster member per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.7.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 6bd7a24b06d743ffbf3435c9254bb29f
              name: 'HA {#HA.ID}: Primary serial number'
              type: DEPENDENT
              key: 'ha.primary.serialnumber[fgHaStatsMasterSerial.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Serial number of the primary HA member during the last sync attempt (successful or not).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.16.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: a91bea47daee4849a94cabd51112c378
              name: 'HA {#HA.ID}: Serial number'
              type: DEPENDENT
              key: 'ha.serialnumber[fgHaStatsSerial.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Serial number of the HA cluster member.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.2.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: 7d2fd05c3a654c33a26e38b2d863a540
              name: 'HA {#HA.ID}: Session count'
              type: DEPENDENT
              key: 'ha.session.count[fgHaStatsSesCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Current session count of the specified cluster member.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.6.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
            - uuid: a2c1bf8ff6b84e468c965b720131caba
              name: 'HA {#HA.ID}: Sync status'
              type: DEPENDENT
              key: 'ha.sync.status[fgHaStatsSyncStatus.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Current HA sync status.
              valuemap:
                name: 'HA sync status'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.13.2.1.1.12.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: ha.members.walk
              tags:
                - tag: component
                  value: ha
                - tag: member
                  value: '{#HA.ID}'
          graph_prototypes:
            - uuid: c7ce26f90264477fb999d52329a9505f
              name: 'HA {#HA.ID}: Bytes processed'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.bytes.rate[fgHaStatsByteCount.{#SNMPINDEX}]'
            - uuid: 3cda6b9299414131a59034791aab1b6f
              name: 'HA {#HA.ID}: CPU usage'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.cpu.usage[fgHaStatsCpuUsage.{#SNMPINDEX}]'
            - uuid: 5684a62bb84849489d66345470879379
              name: 'HA {#HA.ID}: HA events'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.ips.events[fgHaStatsIdsCount.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: template_fortinet_basic
                    key: 'ha.av.events[fgHaStatsAvCount.{#SNMPINDEX}]'
            - uuid: a673a488712b4fa79666e4407b94cbce
              name: 'HA {#HA.ID}: Memory usage'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.mem.usage[fgHaStatsMemUsage.{#SNMPINDEX}]'
            - uuid: 54b23366bb4646fb855a3be566fa41e5
              name: 'HA {#HA.ID}: Network bandwidth usage'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.net.usage[fgHaStatsNetUsage.{#SNMPINDEX}]'
            - uuid: 17a1546eb5b04ca585a955bf2f2d8e55
              name: 'HA {#HA.ID}: Packets processed'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'ha.packets.rate[fgHaStatsPktCount.{#SNMPINDEX}]'
          master_item:
            key: ha.members.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#HA.ID}'
                - 1.3.6.1.4.1.12356.101.13.2.1.1.1
                - '0'
                - '{#HA.SN}'
                - 1.3.6.1.4.1.12356.101.13.2.1.1.2
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 401aae50efb54acba702265eec037f51
          name: fan_discovery
          type: DEPENDENT
          key: hw.fan.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#SENSOR.NAME}'
                value: '.*(FAN|Fan).*'
                formulaid: A
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          item_prototypes:
            - uuid: 73eb8d15bca34dfa978dcc22888259ab
              name: fan_status
              type: DEPENDENT
              key: 'hw.fan.status[fgHwSensorEntStatus.{#INDEX}]'
              delay: '0'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.3.2.1.4.{#INDEX}'
                    - '0'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) {
                          return 1
                      } else {
                          return 2
                      }
              master_item:
                key: hw.sensor.walk
              tags:
                - tag: entity
                  value: '{#SENSOR.NAME}'
              trigger_prototypes:
                - uuid: 49d6d32c9c7048d4a22131c2e54724e7
                  expression: 'min(/template_fortinet_basic/hw.fan.status[fgHwSensorEntStatus.{#INDEX}],#3:now-10m)>1'
                  name: fan_status_abnormal
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
          master_item:
            key: hw.sensor.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#INDEX}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.1
                - '0'
                - '{#SENSOR.NAME}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.2
                - '0'
              error_handler: DISCARD_VALUE
        - uuid: 4b2fc59300fd4711b0bdc086bde1b44e
          name: psu_discovery
          type: DEPENDENT
          key: hw.pus.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#SENSOR.NAME}'
                value: '.*PSU.*'
                formulaid: A
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          item_prototypes:
            - uuid: 60692a74e37749538a0b468c78b74f59
              name: power_supply_status
              type: DEPENDENT
              key: 'hw.psu.status[fgHwSensorEntStatus.{#INDEX}]'
              delay: '0'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.3.2.1.4.{#INDEX}'
                    - '0'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) {
                          return 1
                      } else {
                          return 2
                      }
              master_item:
                key: hw.sensor.walk
              tags:
                - tag: entity
                  value: '{#SENSOR.NAME}'
              trigger_prototypes:
                - uuid: eb0d6af42c4545fea22ccebb5f156816
                  expression: 'min(/template_fortinet_basic/hw.psu.status[fgHwSensorEntStatus.{#INDEX}],#3:now-10m)>1'
                  name: power_status_abnormal
                  priority: WARNING
                  manual_close: 'YES'
          master_item:
            key: hw.sensor.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#INDEX}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.1
                - '0'
                - '{#SENSOR.NAME}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.2
                - '0'
              error_handler: DISCARD_VALUE
        - uuid: ba3ffaf06faa4e65b61cd851d9061725
          name: temperature_discovery
          type: DEPENDENT
          key: hw.temperature.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#SENSOR.NAME}'
                value: '.*(T|t)emperature.*'
                formulaid: A
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          item_prototypes:
            - uuid: a808c1014fba4ccb90c8c5e9d5571a48
              name: temperature
              type: DEPENDENT
              key: 'hw.temperature.value[fgHwSensorEntValue.{#INDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: °C
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.3.2.1.3.{#INDEX}'
                    - '0'
              master_item:
                key: hw.sensor.walk
              tags:
                - tag: entity
                  value: '{#SENSOR.NAME}'
              trigger_prototypes:
                - uuid: b0ee344b23b44cfbb685bccf49dbf4de
                  expression: 'min(/template_fortinet_basic/hw.temperature.value[fgHwSensorEntValue.{#INDEX}],#3:now-10m)>={$TEMP_CRIT}'
                  name: high_temperature
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  manual_close: 'YES'
          master_item:
            key: hw.sensor.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#INDEX}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.1
                - '0'
                - '{#SENSOR.NAME}'
                - 1.3.6.1.4.1.12356.101.4.3.2.1.2
                - '0'
              error_handler: DISCARD_VALUE
        - uuid: ec374a5d51c04d48898a7e53c6fecf52
          name: 'SD-WAN health-check discovery'
          type: DEPENDENT
          key: sdwan_health.discovery
          delay: '0'
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              - macro: '{#HNAME}'
                value: '{$SDWAN.HEALTH.NAME.MATCHES}'
                formulaid: A
              - macro: '{#HNAME}'
                value: '{$SDWAN.HEALTH.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          description: 'Used for discovering SD-WAN health-check from FORTINET-FORTIGATE-MIB.'
          item_prototypes:
            - uuid: f3ef0b7f49884f0fbbfbefe55b6294f5
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Jitter'
              type: DEPENDENT
              key: 'sdwan_health.jitter[fgVWLHealthCheckLinkJitter.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: ms
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                The average jitter of a health check on a specific member link in a float number within the last 30 probes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.6.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 54182f2ead22445aa87b083c14c84118
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Latency'
              type: DEPENDENT
              key: 'sdwan_health.latency[fgVWLHealthCheckLinkLatency.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: ms
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                The average latency of a health check on a specific member link in a float number within the last 30 probes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.5.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b7a91b1cc14843f19c21584582b1b037
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets loss'
              type: DEPENDENT
              key: 'sdwan_health.loss[fgVWLHealthCheckLinkPacketLoss.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                The packet loss percentage of a health check on a specific member link in a float number within the last 30 probes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.9.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 83379ce6348749e7a49d82bd9526ccd6
                  expression: 'min(/template_fortinet_basic/sdwan_health.loss[fgVWLHealthCheckLinkPacketLoss.{#SNMPINDEX}],5m)>{$SDWAN.HEALTH.IF.LOSS.WARN:"{#HNAME}"}'
                  name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: High packets loss'
                  opdata: 'Loss: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'High level of packet loss detected.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: 75b882c99e764567a079d9d50f8c9a34
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets received per second'
              type: DEPENDENT
              key: 'sdwan_health.received[fgVWLHealthCheckLinkPacketRecv.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of packets received by a health check on a specific member link per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.8.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 618af0d434514bccbace4d1b6b892634
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets sent per second'
              type: DEPENDENT
              key: 'sdwan_health.sent[fgVWLHealthCheckLinkPacketSend.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of packets sent by a health check on a specific member link per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.7.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: ac631634fad3483ebf88dd5a53d3b2fa
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Health check state'
              type: DEPENDENT
              key: 'sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Health check state on a specific member link.
              valuemap:
                name: 'Health check state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.4.9.2.1.4.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: sdwan_health.walk
              tags:
                - tag: component
                  value: sd-wan
                - tag: health-check
                  value: '{#HNAME}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 08407dcdee7e408cb7e703b2d7ab8ed2
                  expression: '{$SDWAN.HEALTH.IF.CONTROL:"{#HNAME}"}=1 and last(/template_fortinet_basic/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}])=1 and (last(/template_fortinet_basic/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}],#1)<>last(/template_fortinet_basic/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_fortinet_basic/sdwan_health.state[fgVWLHealthCheckLinkState.{#SNMPINDEX}])<>2 or {$SDWAN.HEALTH.IF.CONTROL:"{#HNAME}"}=0'
                  name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Health check state is dead'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the health check state is dead.
                    2. `{$SDWAN.HEALTH.IF.CONTROL:"{#HNAME}"}=1` - a user can redefine the context macro to "0", marking this health check as not important. No new trigger will be fired if this health check is dead.
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the health check state was up to "1" sometime before.
                    
                    WARNING: If closed manually, it will not fire again on the next poll because of `diff`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: abc8cce6330e439b93bfefd68aa33e50
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Packets statistics'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'sdwan_health.received[fgVWLHealthCheckLinkPacketRecv.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: template_fortinet_basic
                    key: 'sdwan_health.sent[fgVWLHealthCheckLinkPacketSend.{#SNMPINDEX}]'
                - sortorder: '2'
                  drawtype: BOLD_LINE
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: template_fortinet_basic
                    key: 'sdwan_health.loss[fgVWLHealthCheckLinkPacketLoss.{#SNMPINDEX}]'
            - uuid: ebfcf50f4987479782772e4144b72189
              name: 'SD-WAN [{#HNAME}]:[{#IFNAME}]: Performance'
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'sdwan_health.jitter[fgVWLHealthCheckLinkJitter.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: template_fortinet_basic
                    key: 'sdwan_health.latency[fgVWLHealthCheckLinkLatency.{#SNMPINDEX}]'
          master_item:
            key: sdwan_health.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#HNAME}'
                - 1.3.6.1.4.1.12356.101.4.9.2.1.2
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.4.1.12356.101.4.9.2.1.14
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 61e73730029e4383908c7f3b17f872d7
          name: 'Virtual domain discovery'
          type: DEPENDENT
          key: vdom.discovery
          delay: '0'
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              - macro: '{#VDOM.NAME}'
                value: '{$VDOM.NAME.MATCHES}'
                formulaid: A
              - macro: '{#VDOM.NAME}'
                value: '{$VDOM.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          description: 'Used for discovering virtual domains from FORTINET-FORTIGATE-MIB.'
          item_prototypes:
            - uuid: 10e26dbc41d3401f85bff9f6bf66e9ed
              name: 'VDOM {#VDOM.NAME}: CPU usage'
              type: DEPENDENT
              key: 'vdom.cpu.usage[fgVdEntCpuUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                CPU usage of the virtual domain (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.5.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: cpu
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
            - uuid: 2ff604e2879e4ae2816f4fa4060dea58
              name: 'VDOM {#VDOM.NAME}: HA member state'
              type: DEPENDENT
              key: 'vdom.ha.state[fgVdEntHaState.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                HA cluster member state of the virtual domain on this device.
              valuemap:
                name: 'VDOM HA state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.4.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
            - uuid: fb9290ab4eeb455081b1bccfc5d67917
              name: 'VDOM {#VDOM.NAME}: Memory usage'
              type: DEPENDENT
              key: 'vdom.mem.usage[fgVdEntCpuUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Memory usage of the virtual domain (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.6.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: memory
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
            - uuid: 839377a4f6b44a93ae47d132c97ecb93
              name: 'VDOM {#VDOM.NAME}: Operation mode'
              type: DEPENDENT
              key: 'vdom.op_mode[fgVdEntOpMode.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Operation mode of the virtual domain (NAT or Transparent).
              valuemap:
                name: 'VDOM operation mode'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.3.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
            - uuid: 27e8310e99d24435864d06c947546c0a
              name: 'VDOM {#VDOM.NAME}: Sessions rate'
              type: DEPENDENT
              key: 'vdom.sessions.rate[fgVdEntSesRate.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                The session setup rate on the virtual domain per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
            - uuid: e308aa979fe246d48e1e5aaeab345335
              name: 'VDOM {#VDOM.NAME}: Active sessions'
              type: DEPENDENT
              key: 'vdom.sessions[fgVdEntSesCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Number of active sessions on the virtual domain.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.3.2.1.1.7.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vdom.walk
              tags:
                - tag: component
                  value: vdom
                - tag: vdom
                  value: '{#VDOM.NAME}'
          master_item:
            key: vdom.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#VDOM.ID}'
                - 1.3.6.1.4.1.12356.101.3.2.1.1.1
                - '0'
                - '{#VDOM.NAME}'
                - 1.3.6.1.4.1.12356.101.3.2.1.1.2
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 2c233a46acbb4cb79b669a5fbfba359d
          name: 'VPN tunnel discovery'
          type: DEPENDENT
          key: vpn.tunnel.discovery
          delay: '0'
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              - macro: '{#VPN.NAME}'
                value: '{$VPN.NAME.MATCHES}'
                formulaid: A
              - macro: '{#VPN.NAME}'
                value: '{$VPN.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          description: 'Used for discovering VPN tunnels from FORTINET-FORTIGATE-MIB.'
          item_prototypes:
            - uuid: 19c23046efe944858f85504c6241d097
              name: 'VPN {#VPN.NAME}: Tunnel Status'
              type: DEPENDENT
              key: 'vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Current status of tunnel (up or down).
              valuemap:
                name: 'VPN status'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.12.2.2.1.20.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vpn.tunnel.walk
              tags:
                - tag: component
                  value: vpn
                - tag: tunnel
                  value: '{#VPN.NAME}'
              trigger_prototypes:
                - uuid: 3c2189f1899c438dbe13e48f3c9f2331
                  expression: '{$VPN.STATE.CONTROL:"{#VPN.NAME}"}=1 and last(/template_fortinet_basic/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}])=1 and (last(/template_fortinet_basic/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}],#1)<>last(/template_fortinet_basic/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_fortinet_basic/vpn.tunnel.status[fgVpnTunEntStatus.{#SNMPINDEX}])<>1 or {$VPN.STATE.CONTROL:"{#VPN.NAME}"}=0'
                  name: 'VPN {#VPN.NAME}: Tunnel down'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the current tunnel state is down.
                    2. `{$VPN.STATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if this tunnel is down.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: vpn.tunnel.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#VPN.NAME}'
                - 1.3.6.1.4.1.12356.101.12.2.2.1.3
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: be55510ee98a469683ab35b51f3e7a26
          name: 'Wireless discovery'
          type: DEPENDENT
          key: wireless.discovery
          delay: '0'
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              - macro: '{#WC.NAME}'
                value: '{$WC.NAME.MATCHES}'
                formulaid: A
              - macro: '{#WC.NAME}'
                value: '{$WC.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          description: 'Used for discovering wireless access points from FORTINET-FORTIGATE-MIB.'
          item_prototypes:
            - uuid: 81b4b952b9e54b74a03798fa1baa0766
              name: 'WTP {#WC.NAME}: Administrative status'
              type: DEPENDENT
              key: 'wc.admin.status[fgWcWtpConfigWtpAdmin.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the administrative status of this wireless termination point (WTP).
                
                The following enumerated values are supported:
                `discovered(1)` - This WTP was discovered though discovery or join request messages.
                `disable(2)` - Controller is configured to not provide service to this WTP.
                `enable(3)` - Controller is configured to provide service to this WTP.
                `other(0)` - The administration state of the WTP is unknown.
              valuemap:
                name: 'Wireless admin status'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.2.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: f3eea58705bd4156b29ece1a6b2f2373
              name: 'WTP {#WC.NAME}: Background scan'
              type: DEPENDENT
              key: 'wc.background.scan[fgWcWtpConfigRadioApScan.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Whether background scan is enabled on this WTP.
              valuemap:
                name: 'Option state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.12.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 4c8b4593b0d943d29e72d131490af988
              name: 'WTP {#WC.NAME}: Base MAC Address'
              type: DEPENDENT
              key: 'wc.base.mac[fgWcWtpSessionWtpBaseMacAddress.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the WTP's Base MAC Address, which MAY be assigned to the primary Ethernet interface.
                The instance of the object corresponds to the Base MAC Address sub-element in the CAPWAP protocol [RFC5415].
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.6.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: a3284945870243a2b4cb3ed1be43626e
              name: 'WTP {#WC.NAME}: Bootloader version'
              type: DEPENDENT
              key: 'wc.boot.version[fgWcWtpSessionWtpBootVersion.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the boot loader version of a WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.15.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 52d14e4b39734fe5b889d8e8d3dad216
              name: 'WTP {#WC.NAME}: Connected clients'
              type: DEPENDENT
              key: 'wc.clients.num[fgWcWtpSessionWtpStationCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the number of clients currently connected to this WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.17.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 38fc6b96e82e4df0b5a4d48c48b3c1e5
              name: 'WTP {#WC.NAME}: Connection status'
              type: DEPENDENT
              key: 'wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the connection status of a WTP to the AC.
                
                The following enumerated values are supported:
                `offLine(1)` - The WTP is not connected.
                `onLine(2)` - The WTP is connected.
                `downloadingImage(3)` - The WTP is downloading software image from the AC on joining.
                `connectedImage(4)` - The AC is pushing a software image to the connected WTP.
                `other(0)` - The WTP connection status is unknown.
              valuemap:
                name: 'Wireless connection status'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.7.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
              trigger_prototypes:
                - uuid: 650b81c809cd4134a917088443823099
                  expression: '{$WC.STATE.CONTROL:"{#WC.NAME}"}=1 and last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=1 and (last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=2 or {$WC.STATE.CONTROL:"{#WC.NAME}"}=0'
                  name: 'WTP {#WC.NAME}: Connection is down'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the current connection status is `offLine`.
                    2. `{$WC.STATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if this connection is down.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 4b39886eba43400cbb75c36468f93419
                  expression: '{$WC.UPDATE.CONTROL:"{#WC.NAME}"}=1 and last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=3 and (last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=2 or {$WC.UPDATE.CONTROL:"{#WC.NAME}"}=0'
                  name: 'WTP {#WC.NAME}: Receiving firmware update'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the current connection status is `downloadingImage`.
                    2. `{$WC.UPDATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if the status is `downloadingImage`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
                - uuid: 40c5b992aed349cf894480b3bd5ac100
                  expression: '{$WC.UPDATE.CONTROL:"{#WC.NAME}"}=1 and last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=4 and (last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#1)<>last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_fortinet_basic/wc.conn.status[fgWcWtpSessionConnectionState.{#SNMPINDEX}])=2 or {$WC.UPDATE.CONTROL:"{#WC.NAME}"}=0'
                  name: 'WTP {#WC.NAME}: Sending firmware update'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the current connection status is `connectedImage`.
                    2. `{$WC.UPDATE.CONTROL}=1` - a user can redefine the context macro to "0", marking this notification as not important. No new trigger will be fired if the status is `connectedImage`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 60114431c70944aab6bd42791f2b2077
              name: 'WTP {#WC.NAME}: CPU usage'
              type: DEPENDENT
              key: 'wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the current CPU usage of a WTP (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.20.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: cpu
                - tag: component
                  value: wireless
              trigger_prototypes:
                - uuid: 92a4ae4a8c594738b9811df6762b66e9
                  expression: 'min(/template_fortinet_basic/wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}],5m)>{$WC.CPU.UTIL.CRIT:"{#WC.NAME}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/template_fortinet_basic/wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}],5m)<{$WC.CPU.UTIL.CRIT:"{#WC.NAME}"}'
                  name: 'WTP {#WC.NAME}: High CPU utilization'
                  event_name: 'WTP {#WC.NAME}: High CPU utilization (over {$WC.CPU.UTIL.CRIT:"{#WC.NAME}"}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The CPU utilization is too high.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: 50c25cb9eef04ac38cf4e918b0cd57ee
              name: 'WTP {#WC.NAME}: Daemon uptime'
              type: DEPENDENT
              key: 'wc.daemon.uptime[fgWcWtpSessionWtpDaemonUpTime.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: uptime
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the time since the WTP daemon has been started.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.9.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 58a27af518454d57b2dd69e45be989fc
              name: 'WTP {#WC.NAME}: Hardware version'
              type: DEPENDENT
              key: 'wc.hardware.version[fgWcWtpSessionWtpHwVersion.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the hardware version of a WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.13.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: ff08941473194ca383e9e014b5d3673b
              name: 'WTP {#WC.NAME}: IP Address'
              type: DEPENDENT
              key: 'wc.ip.addr[fgWcWtpSessionWtpIpAddress.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the IP address of a WTP that corresponds to the IP address in the IP packet header.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: c66c9cbaed684141be2b18c8b0ff67c8
              name: 'WTP {#WC.NAME}: IP Address type'
              type: DEPENDENT
              key: 'wc.ip.type[fgWcWtpSessionWtpIpAddressType.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the IP address type of a WTP.
              valuemap:
                name: 'IP Address type'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.2.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: a97e0f7d116941d28a3d09745e778d61
              name: 'WTP {#WC.NAME}: Local IP Address'
              type: DEPENDENT
              key: 'wc.local_ip.addr[fgWcWtpSessionWtpLocalIpAddress.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the local IP address of a WTP and models the CAPWAP Local IPv4 Address or CAPWAP Local IPv6 Address fields [RFC5415].
                If a Network Address Translation (NAT) device is present between the WTP and access controller (AC), the value of `fgWcWtpWtpLocalIpAddress` will be different from the value of `fgWcWtpWtpIpAddress`.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 51cea66873734b7d977fbc0079732bda
              name: 'WTP {#WC.NAME}: Local IP Address type'
              type: DEPENDENT
              key: 'wc.local_ip.type[fgWcWtpSessionWtpLocalIpAddressType.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the local IP address type of a WTP.
              valuemap:
                name: 'IP Address type'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.4.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 0179d1a7eea04f2ab26a587414c704ea
              name: 'WTP {#WC.NAME}: Location'
              type: DEPENDENT
              key: 'wc.location[fgWcWtpConfigWtpLocation.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the location of this WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.4.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 21cac195271449e89616bd792e3c7a39
              name: 'WTP {#WC.NAME}: Memory capacity'
              type: DEPENDENT
              key: 'wc.mem.size[fgWcWtpSessionWtpMemoryCapacity.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: B
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the total physical memory (RAM) installed.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.22.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: memory
                - tag: component
                  value: wireless
            - uuid: 0a5d2b770ad94d15837497e42aabd861
              name: 'WTP {#WC.NAME}: Memory usage'
              type: DEPENDENT
              key: 'wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the current memory usage of a WTP (percentage).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.21.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: memory
                - tag: component
                  value: wireless
              trigger_prototypes:
                - uuid: d9ce328b27574b589408ca17e3903a9b
                  expression: 'min(/template_fortinet_basic/wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}],5m)>{$WC.MEMORY.UTIL.MAX:"{#WC.NAME}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/template_fortinet_basic/wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}],5m)<{$WC.MEMORY.UTIL.MAX:"{#WC.NAME}"}'
                  name: 'WTP {#WC.NAME}: High memory utilization'
                  event_name: 'WTP {#WC.NAME}: High memory utilization (>{$WC.MEMORY.UTIL.MAX:"{#WC.NAME}"}% for 5m)'
                  priority: WARNING
                  description: 'The WTP is running out of free memory.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: 8d0d796813814e5e97b08adb4928cd7d
              name: 'WTP {#WC.NAME}: Model number'
              type: DEPENDENT
              key: 'wc.model[fgWcWtpSessionWtpModelNumber.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the model number of a WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.12.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: ee35ce33fb514d6a90d996fba8c2e49b
              name: 'WTP {#WC.NAME}: Profile name'
              type: DEPENDENT
              key: 'wc.profile[fgWcWtpConfigWtpProfile.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the profile configured for this WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: f0cdb30b54f5498c9a8ee4a795437e5d
              name: 'WTP {#WC.NAME}: Radio ATPC high limit'
              type: DEPENDENT
              key: 'wc.radio.atpc.high_limit[fgWcWtpConfigRadioAutoTxPowerHigh.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: '!dBm'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the high limit of radio automatic TX power control configured for this WTP, in dBm.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.9.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 2f67545eb5ae4e55a51f64376df5d03a
              name: 'WTP {#WC.NAME}: Radio ATPC low limit'
              type: DEPENDENT
              key: 'wc.radio.atpc.low_limit[fgWcWtpConfigRadioAutoTxPowerLow.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: '!dBm'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the low limit of radio automatic TX power control configured for this WTP, in dBm.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.8.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 64ba0af275354d529c23535b12a6663e
              name: 'WTP {#WC.NAME}: Radio ATPC status'
              type: DEPENDENT
              key: 'wc.radio.atpc.status[fgWcWtpConfigRadioAutoTxPowerControl.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Whether radio automatic TX power control is enabled on this WTP.
              valuemap:
                name: 'Option state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.7.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 75a5e7a7eb1341eba84c8b905b5d8cc0
              name: 'WTP {#WC.NAME}: Radio band'
              type: DEPENDENT
              key: 'wc.radio.band[fgWcWtpConfigRadioBand.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the radio band configured for this WTP.
              valuemap:
                name: 'Wireless band type'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.11.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 0fb795c1e22647fa9ab0214fada37e0e
              name: 'WTP {#WC.NAME}: Radio enabled'
              type: DEPENDENT
              key: 'wc.radio.enabled[fgWcWtpConfigRadioEnable.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Whether radio is enabled for this WTP.
              valuemap:
                name: 'Option state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.6.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 2341da9e349241d19192030232c101ba
              name: 'WTP {#WC.NAME}: Radio TX power level'
              type: DEPENDENT
              key: 'wc.radio.power_level[fgWcWtpConfigRadioTxPowerLevel.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the radio TX power setting configured for this WTP, expressed in %.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.10.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 0d0c0fb03bfe48bf95a86a459f8938de
              name: 'WTP {#WC.NAME}: Bits received'
              type: DEPENDENT
              key: 'wc.rate.in[fgWcWtpSessionWtpByteRxCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: bps
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the number of bits received by this WTP per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.18.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: a390cb0ba0d64f5faffbe59fdbbda8de
              name: 'WTP {#WC.NAME}: Bits sent'
              type: DEPENDENT
              key: 'wc.rate.out[fgWcWtpSessionWtpByteTxCount.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: bps
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the number of bits transmitted by this WTP per second.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 18358c2629904ea285946000bc28b664
              name: 'WTP {#WC.NAME}: Region code'
              type: DEPENDENT
              key: 'wc.region_code[fgWcWtpSessionWtpRegionCode.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the region code programmed for this WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.16.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: fb138eb2061240b2942a3c41ec298808
              name: 'WTP {#WC.NAME}: Session uptime'
              type: DEPENDENT
              key: 'wc.session.uptime[fgWcWtpSessionWtpSessionUpTime.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: uptime
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the time since the WTP has been connected to the AC.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.10.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
              trigger_prototypes:
                - uuid: f576e866eff24f20a4b20f776599dd53
                  expression: 'last(/template_fortinet_basic/wc.session.uptime[fgWcWtpSessionWtpSessionUpTime.{#SNMPINDEX}])<10m'
                  name: 'WTP {#WC.NAME}: Session has been restarted'
                  event_name: 'WTP {#WC.NAME}: Session has been restarted (uptime < 10m)'
                  priority: INFO
                  description: 'Uptime is less than 10 minutes.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 1ee8fc40bed34c8e8b486c1b0f483d25
              name: 'WTP {#WC.NAME}: Software version'
              type: DEPENDENT
              key: 'wc.software.version[fgWcWtpSessionWtpSwVersion.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the software version of a WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.14.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 5474f9786bfe4b3799cf1a4daa4797e3
              name: 'WTP {#WC.NAME}: Uptime'
              type: DEPENDENT
              key: 'wc.uptime[fgWcWtpSessionWtpUpTime.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: uptime
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents the time since the WTP has booted.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.4.1.8.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: 47fb5ecca07a40b192899d6e2b027e48
              name: 'WTP {#WC.NAME}: All VAPs selected'
              type: DEPENDENT
              key: 'wc.vaps.all[fgWcWtpConfigVapAll.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Whether all wireless virtual access points (VAP) are selected for this WTP.
              valuemap:
                name: 'Option state'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.13.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
            - uuid: dc7f9348b74441179207f2bb2d7fa989
              name: 'WTP {#WC.NAME}: VAPs list'
              type: DEPENDENT
              key: 'wc.vaps.list[fgWcWtpConfigVaps.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: |
                MIB: FORTINET-FORTIGATE-MIB
                Represents a list of wireless virtual access points (VAP) configured for this WTP.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.12356.101.14.4.3.1.14.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: wireless.ap.walk
              tags:
                - tag: access-point
                  value: '{#WC.NAME}'
                - tag: component
                  value: wireless
          graph_prototypes:
            - uuid: bf142c2d937f4f7284807ef6c91e452c
              name: 'WTP {#WC.NAME}: Clients'
              ymin_type_1: FIXED
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'wc.clients.num[fgWcWtpSessionWtpStationCount.{#SNMPINDEX}]'
            - uuid: d8396631504440f1924adc834a573bd4
              name: 'WTP {#WC.NAME}: Network traffic'
              ymin_type_1: FIXED
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'wc.rate.in[fgWcWtpSessionWtpByteRxCount.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: template_fortinet_basic
                    key: 'wc.rate.out[fgWcWtpSessionWtpByteTxCount.{#SNMPINDEX}]'
            - uuid: 0d9f41f7dfa5495c8b7a4fac78b58146
              name: 'WTP {#WC.NAME}: Performance'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 199C0D
                  item:
                    host: template_fortinet_basic
                    key: 'wc.cpu.usage[fgWcWtpSessionWtpCpuUsage.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: template_fortinet_basic
                    key: 'wc.mem.usage[fgWcWtpSessionWtpMemoryUsage.{#SNMPINDEX}]'
          master_item:
            key: wireless.ap.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#WC.ID}'
                - 1.3.6.1.4.1.12356.101.14.4.3.1.1
                - '0'
                - '{#WC.NAME}'
                - 1.3.6.1.4.1.12356.101.14.4.3.1.3
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      macros:
        - macro: '{$CPU.USAGE.HIGH}'
          value: '90'
          description: 'Threshold of CPU utilization for Warning trigger in %.'
        - macro: '{$DISK.FREE.CRIT}'
          value: '10'
          description: 'Threshold of disk free space for Critical trigger in %.'
        - macro: '{$DISK.FREE.WARN}'
          value: '20'
          description: 'Threshold of disk free space for Warning trigger in %.'
        - macro: '{$HA.MEMBER.SN.MATCHES}'
          value: '.*'
          description: 'Used in HA member discovery. Can be overridden on the host or linked template level.'
        - macro: '{$HA.MEMBER.SN.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in HA member discovery. Can be overridden on the host or linked template level.'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Threshold of ICMP packet loss for Warning trigger in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Threshold of average ICMP response time for Warning trigger in seconds.'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Threshold of error packet rate for Warning trigger. Can be used with interface name as context.'
        - macro: '{$MEMORY.UTIL.HIGH}'
          value: '90'
          description: 'Threshold of memory utilization for trigger in %.'
        - macro: '{$SDWAN.HEALTH.IF.CONTROL}'
          value: '1'
          description: 'Used in "Health check state is dead" trigger. Can be used with health check name as context.'
        - macro: '{$SDWAN.HEALTH.IF.LOSS.WARN}'
          value: '20'
          description: 'Threshold of packet loss for Warning trigger in %. Can be used with health check name as context.'
        - macro: '{$SDWAN.HEALTH.NAME.MATCHES}'
          value: '.*'
          description: 'Used in SD-WAN health-check discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SDWAN.HEALTH.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in SD-WAN health-check discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'The time interval for SNMP availability trigger.'
        - macro: '{$TEMP_CRIT}'
          value: '75'
        - macro: '{$VDOM.NAME.MATCHES}'
          value: '.*'
          description: 'Used in Virtual domain discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VDOM.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in Virtual domain discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VPN.NAME.MATCHES}'
          value: '.*'
          description: 'Used in VPN tunnel discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VPN.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in VPN tunnel discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VPN.STATE.CONTROL}'
          value: '1'
          description: 'Used in "Tunnel down" trigger. Can be used with interface name as context.'
        - macro: '{$WC.CPU.UTIL.CRIT}'
          value: '90'
          description: 'Threshold of WTP CPU utilization for Warning trigger in %. Can be used with interface name as context.'
        - macro: '{$WC.MEMORY.UTIL.MAX}'
          value: '90'
          description: 'Threshold of WTP memory utilization for trigger in %. Can be used with interface name as context.'
        - macro: '{$WC.NAME.MATCHES}'
          value: '.*'
          description: 'Used in Wireless discovery. Can be overridden on the host or linked template level.'
        - macro: '{$WC.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in Wireless discovery. Can be overridden on the host or linked template level.'
        - macro: '{$WC.STATE.CONTROL}'
          value: '1'
          description: 'Used in "Connection down" trigger. Can be used with interface name as context.'
        - macro: '{$WC.UPDATE.CONTROL}'
          value: '1'
          description: 'Used in "Receiving firmware update" trigger. Can be used with interface name as context.'
      valuemaps:
        - uuid: decc46a9a55c471a9d885b65a223b722
          name: entity_status
          mappings:
            - value: '1'
              newvalue: normal
            - value: '2'
              newvalue: abnormal
        - uuid: 1dbf713dd49c4026af164b5ed47bdd26
          name: 'HA load-balancing schedule'
          mappings:
            - value: '1'
              newvalue: none
            - value: '2'
              newvalue: hub
            - value: '3'
              newvalue: leastConnections
            - value: '4'
              newvalue: roundRobin
            - value: '5'
              newvalue: weightedRoundRobin
            - value: '6'
              newvalue: random
            - value: '7'
              newvalue: ipBased
            - value: '8'
              newvalue: ipPortBased
        - uuid: 2873cdaaaae341e5acb156d121281206
          name: 'HA option status'
          mappings:
            - value: '1'
              newvalue: disabled
            - value: '2'
              newvalue: enabled
        - uuid: 63065bf845e74f16a40eee08d7f6f83f
          name: 'HA sync status'
          mappings:
            - value: '0'
              newvalue: unsynchronized
            - value: '1'
              newvalue: synchronized
        - uuid: 61665225cac140fcbc0fa27195394711
          name: 'HA system mode'
          mappings:
            - value: '1'
              newvalue: standalone
            - value: '2'
              newvalue: activeActive
            - value: '3'
              newvalue: activePassive
        - uuid: 3b682677b66345aaa29d7e9057a4a170
          name: 'Health check state'
          mappings:
            - value: '0'
              newvalue: alive
            - value: '1'
              newvalue: dead
        - uuid: 25aca65b63dd44a79ac8a510ff4fd038
          name: 'Host availability status'
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: ed053846d5c94b428163ec697a47468a
          name: 'Interface status'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '3'
              newvalue: testing
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: c024d04f6f9a4c1e9e4a56eb37f7ad94
          name: 'Interface type'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: ca4f6ff6522b4f9dae68a2d90784c1e0
          name: 'IP Address type'
          mappings:
            - value: '1'
              newvalue: ipv4
            - value: '2'
              newvalue: ipv6
        - uuid: 9f56fc6edb694244b9118a6a54ddc34c
          name: 'Option state'
          mappings:
            - value: '1'
              newvalue: disabled
            - value: '2'
              newvalue: enabled
        - uuid: 59f17c38cb77485f9889dbcbe5e8e9fe
          name: 'Sensor alert status'
          mappings:
            - value: '0'
              newvalue: 'false'
            - value: '1'
              newvalue: 'true'
        - uuid: a2063cc49e994c538e3f72479013b855
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: down
            - value: '1'
              newvalue: up
        - uuid: fe792cb82c5443e3a76c6eb4ccbe2013
          name: 'VDOM HA state'
          mappings:
            - value: '1'
              newvalue: primary
            - value: '2'
              newvalue: secondary
            - value: '3'
              newvalue: standalone
        - uuid: 26a90e47db204f2abd817f8c46226679
          name: 'VDOM operation mode'
          mappings:
            - value: '1'
              newvalue: nat
            - value: '2'
              newvalue: transparent
        - uuid: e0ecba5f8fd84ee29ecbaec8dbfb8e02
          name: 'VPN status'
          mappings:
            - value: '1'
              newvalue: down
            - value: '2'
              newvalue: up
        - uuid: 3bf140d7812d4f71ac7d8cfa89f73910
          name: 'Wireless admin status'
          mappings:
            - value: '0'
              newvalue: other
            - value: '1'
              newvalue: discovered
            - value: '2'
              newvalue: disable
            - value: '3'
              newvalue: enable
        - uuid: 867f8efafad243989ea83497f7d8f8fd
          name: 'Wireless band type'
          mappings:
            - value: '0'
              newvalue: other
            - value: '1'
              newvalue: 2Ghz
            - value: '2'
              newvalue: 5Ghz
        - uuid: a01d1ec02aa6488f9c008ce365dcca8e
          name: 'Wireless connection status'
          mappings:
            - value: '0'
              newvalue: other
            - value: '1'
              newvalue: offLine
            - value: '2'
              newvalue: onLine
            - value: '3'
              newvalue: downloadingImage
            - value: '4'
              newvalue: connectedImage
