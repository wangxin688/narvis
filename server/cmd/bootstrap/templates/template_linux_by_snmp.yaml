zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  templates:
    - uuid: 498280f863f1455693f99b2ffa0b609e
      template: template_linux_by_snmp
      name: template_linux_by_snmp
      description: |
        This is an official Linux template. It requires an SNMP client.
        
        MIBs used:
        EtherLike-MIB
        HOST-RESOURCES-MIB
        SNMPv2-MIB
        UCD-DISKIO-MIB
        UCD-SNMP-MIB
        IF-MIB
        
        Notes on filesystem (FS) discovery:
          - The ext4/3/2 FS reserves space for privileged usage, typically set at 5% by default.
          - BTRFS allocates a default of 10% of the volume for its own needs.
          - To mitigate potential disasters, FS usage triggers are based on the maximum available space.
            - Utilization formula: 'pused = 100 * (used / used + available)'
          - The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux
        
        Generated by official Zabbix template tool "Templator"
      groups:
        - name: 'Templates/Operating systems'
      items:
        - uuid: ee5187a6657b4391abd5c4d393f9b693
          name: icmp_ping
          type: SIMPLE
          key: icmpping
          delay: 3m
          history: 7d
          trends: '0'
          valuemap:
            name: 'Service state'
          triggers:
            - uuid: d59595b63acf4bc28c0c17749856c148
              expression: 'max(/template_linux_by_snmp/icmpping,#3)=0'
              name: unavailable_by_icmp_ping
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
        - uuid: 2204b696a10741bb9e6ba064a9758643
          name: icmp_loss
          type: SIMPLE
          key: icmppingloss
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          triggers:
            - uuid: 72257a669dc3497fb3f2066ebba83182
              expression: 'min(/template_linux_by_snmp/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/template_linux_by_snmp/icmppingloss,5m)<100'
              name: high_icmp_ping_loss
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_linux_by_snmp/icmpping,#3)=0'
        - uuid: ddea4258392d4cdd90e684883970999b
          name: icmp_response_time
          type: SIMPLE
          key: icmppingsec
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: s
          triggers:
            - uuid: fd5268575f2e43e7997e4917c19326e6
              expression: 'avg(/template_linux_by_snmp/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: high_icmp_ping_response_time
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: high_icmp_ping_loss
                  expression: 'min(/template_linux_by_snmp/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/template_linux_by_snmp/icmppingloss,5m)<100'
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_linux_by_snmp/icmpping,#3)=0'
        - uuid: 0b66e2fc69d94cffaa2dd65c6a8ffc5e
          name: snmp_walk_duplex
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.10.7.2.1.19,1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2]'
          key: net.if.duplex.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with `up(1)` Operational Status are discovered.'
        - uuid: 5ddf28652677495f91bcdc7029b0b620
          name: snmp_walk_interfaces
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.31.1.1.1.6,1.3.6.1.2.1.31.1.1.1.10,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.31.1.1.1.15]'
          key: net.if.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Discovering interfaces from IF-MIB.'
        - uuid: d3c2a51e00414c66b3536e4d6e2b6436
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          delay: '0'
          history: 7d
          value_type: LOG
          trends: '0'
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
        - uuid: 8c4c6dc4439141e68d8ae4ac03f0f01c
          name: Interrupts_per_second
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.11.59.0
          key: 'system.cpu.intr[ssRawInterrupts.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: 'Number of interrupts processed.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: cb0407058b1a4747b3505643fd2e6ba0
          name: load_average_1m
          type: SNMP_AGENT
          snmp_oid: '1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-1"]'
          key: 'system.cpu.load.avg1[laLoad.1]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: 'MIB: UCD-SNMP-MIB'
        - uuid: 2620c1e323244310bef08188ae7f39ee
          name: load_average_5m
          type: SNMP_AGENT
          snmp_oid: '1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-5"]'
          key: 'system.cpu.load.avg5[laLoad.2]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: 'MIB: UCD-SNMP-MIB'
        - uuid: 9c41fe98b1994677823c1f415c848b3e
          name: load_average_15m
          type: SNMP_AGENT
          snmp_oid: '1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-15"]'
          key: 'system.cpu.load.avg15[laLoad.3]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: 'MIB: UCD-SNMP-MIB'
        - uuid: 791b538e28d54a46ac5e58ca364e04f2
          name: number_of_cpus
          type: DEPENDENT
          key: 'system.cpu.num[snmp]'
          delay: '0'
          history: 7d
          trends: '0'
          description: 'Count the number of CPU cores by counting number of cores discovered in hrProcessorTable using LLD.'
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.2.1.25.3.3.1.1
                - '0'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).length;'
          master_item:
            key: system.cpu.walk
        - uuid: 637536ebae8c4671bfaeb6c50dd32bb6
          name: context_switch_per_second
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.11.60.0
          key: 'system.cpu.switches[ssRawContexts.0]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          description: 'The combined rate at which all processors on the computer are switched from one thread to another.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: c8804fcacfb049e2bb5e22f04d655534
          name: 'SNMP walk system CPUs'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.25.3.3.1.1,1.3.6.1.4.1.2021.11.53.0,1.3.6.1.4.1.2021.11.52.0,1.3.6.1.4.1.2021.11.50.0,1.3.6.1.4.1.2021.11.64.0,1.3.6.1.4.1.2021.11.61.0,1.3.6.1.4.1.2021.11.51.0,1.3.6.1.4.1.2021.11.54.0,1.3.6.1.4.1.2021.11.56.0,1.3.6.1.4.1.2021.11.65.0,1.3.6.1.4.1.2021.11.66.0]'
          key: system.cpu.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: |
            MIB: HOST-RESOURCES-MIB
            Discovering system CPUs.
        - uuid: 6d252f964d774449a33cfd6be7557c4a
          name: uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
        - uuid: d605249a3f9d4c488839ecb589b97abb
          name: free_swap_space
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.4.0
          key: 'system.swap.free[memAvailSwap.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The amount of swap space currently unused or available.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: 31a4950ec54f48ea97a5540f79171711
          name: swap_space_utilization
          type: CALCULATED
          key: 'system.swap.pfree[snmp]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          params: '100-last(//system.swap.free[memAvailSwap.0])/last(//system.swap.total[memTotalSwap.0])*100'
          description: 'The free space of the swap volume/file expressed in %.'
        - uuid: 40d7ac6c0f75422b87a65de0f0c27ce7
          name: 'Total swap space'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.3.0
          key: 'system.swap.total[memTotalSwap.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total amount of swap space configured for this host.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: bf8c39e846fe44a28fb830dcb93c141b
          name: 'SNMP walk block devices'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.13.15.1.1.2,1.3.6.1.4.1.2021.13.15.1.1.5,1.3.6.1.4.1.2021.13.15.1.1.6,1.3.6.1.4.1.2021.13.15.1.1.9]'
          key: vfs.dev.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable).'
        - uuid: a3b629ca9d8541cbaf208226d961e30e
          name: 'SNMP walk mounted filesystems'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.9.1.1,1.3.6.1.4.1.2021.9.1.2,1.3.6.1.4.1.2021.9.1.3,1.3.6.1.4.1.2021.9.1.10,1.3.6.1.4.1.2021.9.1.11,1.3.6.1.4.1.2021.9.1.12,1.3.6.1.4.1.2021.9.1.13,1.3.6.1.4.1.2021.9.1.14,1.3.6.1.4.1.2021.9.1.15,1.3.6.1.4.1.2021.9.1.16]'
          key: vfs.fs.walk
          delay: 3m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: |
            MIB: UCD-SNMP-MIB
            Snmp walk through dskEntry table. Collected data used in filesystem lld and dependent item prototypes.
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - dskPath
                - 1.3.6.1.4.1.2021.9.1.2
                - '0'
                - dskDevice
                - 1.3.6.1.4.1.2021.9.1.3
                - '0'
                - dskPercentNode
                - 1.3.6.1.4.1.2021.9.1.10
                - '0'
                - dskTotalLow
                - 1.3.6.1.4.1.2021.9.1.11
                - '0'
                - dskTotalHigh
                - 1.3.6.1.4.1.2021.9.1.12
                - '0'
                - dskAvailLow
                - 1.3.6.1.4.1.2021.9.1.13
                - '0'
                - dskAvailHigh
                - 1.3.6.1.4.1.2021.9.1.14
                - '0'
                - dskUsedLow
                - 1.3.6.1.4.1.2021.9.1.15
                - '0'
                - dskUsedHigh
                - 1.3.6.1.4.1.2021.9.1.16
                - '0'
                - dskEntry
                - 1.3.6.1.4.1.2021.9.1.1
                - '0'
        - uuid: 8b6c01695074444dbbcff4e951f4370c
          name: available_memory
          type: CALCULATED
          key: 'vm.memory.available[snmp]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          params: 'last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
        - uuid: 416a93cd2954404a95edc1c068f75420
          name: memory_buffers
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.14.0
          key: 'vm.memory.buffers[memBuffer.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Memory used by kernel buffers (Buffers in /proc/meminfo).
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: 8b7683b390844d62bf0aa3557d18726d
          name: memory_cached
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.15.0
          key: 'vm.memory.cached[memCached.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Memory used by the page cache and slabs (Cached and Slab in /proc/meminfo).
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: 004761e5a08d4878929315e2c67ea023
          name: free_memory
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.6.0
          key: 'vm.memory.free[memAvailReal.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: 5922a615ca0a42d8acf46b83d5c289c3
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.5.0
          key: 'vm.memory.total[memTotalReal.0]'
          delay: 3m
          history: 7d
          trends: '0'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Total memory expressed in bytes.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
        - uuid: c031b50025f74bbe8b0a31752a72290c
          name: memory_utilization
          type: CALCULATED
          key: 'vm.memory.util[snmp]'
          delay: 3m
          history: 7d
          value_type: FLOAT
          trends: '0'
          units: '%'
          params: '(last(//vm.memory.total[memTotalReal.0])-(last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])))/last(//vm.memory.total[memTotalReal.0])*100'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          triggers:
            - uuid: 12f91484f2e94630a6f2fc082931af8b
              expression: 'min(/template_linux_by_snmp/vm.memory.util[snmp],5m)>{$MEMORY.UTIL.MAX}'
              name: high_memory_utilization
              event_name: 'High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
        - uuid: 39d851b4700a46ce9430f8d108ed9630
          name: snmp_agent_availability
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          delay: 3m
          history: 7d
          trends: '0'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          triggers:
            - uuid: e49f32dc2db24925aaa2d64622f1e128
              expression: 'max(/template_linux_by_snmp/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: no_snmp_data_collection
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: unavailable_by_icmp_ping
                  expression: 'max(/template_linux_by_snmp/icmpping,#3)=0'
      discovery_rules:
        - uuid: 7d40439730d043a199656fb880cb0496
          name: 'CPU discovery'
          type: DEPENDENT
          key: 'cpu.discovery[snmp]'
          delay: '0'
          description: 'This discovery will create set of per core CPU metrics from UCD-SNMP-MIB, using {#CPU.COUNT} in preprocessing. That''s the only reason why LLD is used.'
          item_prototypes:
            - uuid: ce20b1931bc14f66b6bfe6c4f5bfd21a
              name: cpu_guest_time
              type: DEPENDENT
              key: 'system.cpu.guest[ssCpuRawGuest.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time spent on running a virtual CPU for a guest operating system.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.65.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: eb60e065e8ed412aa89fadb11e00fe16
              name: cpu_guest_nice_time
              type: DEPENDENT
              key: 'system.cpu.guest_nice[ssCpuRawGuestNice.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time spent on running a niced guest (a virtual CPU for guest operating systems under the control of the Linux kernel).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.66.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: d7c1f795267b4ad4a936c7c94ca58a7a
              name: cpu_idle_time
              type: DEPENDENT
              key: 'system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent doing nothing.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.53.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: 052d624fda8d4734b1c448c46153d00c
              name: cpu_interrupt_time
              type: DEPENDENT
              key: 'system.cpu.interrupt[ssCpuRawInterrupt.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent servicing hardware interrupts.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.56.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: ba6debd0a1c3438d9f6649daab411b7a
              name: cpu_iowait_time
              type: DEPENDENT
              key: 'system.cpu.iowait[ssCpuRawWait.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has been waiting for I/O to complete.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.54.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: 1f1c27685ac14e258602411467d0a589
              name: cpu_nice_time
              type: DEPENDENT
              key: 'system.cpu.nice[ssCpuRawNice.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running users' processes that have been niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.51.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: fdceafbcdefe4bc8ab1b89107e376ab8
              name: cpu_softirq_time
              type: DEPENDENT
              key: 'system.cpu.softirq[ssCpuRawSoftIRQ.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has been servicing software interrupts.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.61.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: a8515188968244c1b44b2473bd45da86
              name: cpu_steal_time
              type: DEPENDENT
              key: 'system.cpu.steal[ssCpuRawSteal.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The amount of "stolen" CPU from this virtual machine by the hypervisor for other tasks, such as running another virtual machine.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.64.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: a6da16f0a1b34880b9d07a9328c62f06
              name: cpu_system_time
              type: DEPENDENT
              key: 'system.cpu.system[ssCpuRawSystem.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running the kernel and its processes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.52.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: 040ef672e36448a49a8023eabd267ed7
              name: cpu_user_time
              type: DEPENDENT
              key: 'system.cpu.user[ssCpuRawUser.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running users' processes that are not niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.50.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
            - uuid: cac437d956e8496990f0048979d6fc72
              name: cpu_utilization
              type: DEPENDENT
              key: 'system.cpu.util[snmp,{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: 'CPU utilization expressed in %.'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              master_item:
                key: 'system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]'
              trigger_prototypes:
                - uuid: 85646e4f86f540389b42ad2f4a055a60
                  expression: 'min(/template_linux_by_snmp/system.cpu.util[snmp,{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: high_cpu_utilization
                  event_name: 'High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
          master_item:
            key: 'system.cpu.num[snmp]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.stringify([{"{#CPU.COUNT}": value, "{#SNMPINDEX}": 0, "{#SINGLETON}":""}])'
        - uuid: aba6b055f0614035b3c680dc3f39cbee
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: 6dbbbeb2537944f494dd1e0449566a29
              name: rx_discards
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 1135621c71c944ccba37a53ddcc20694
              name: rx_errors
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b320bb84237f491c84065320cee07eaa
              name: rx_bits
              type: DEPENDENT
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 246004a0d2704c90bc2857f9bd06bdac
              name: tx_discards
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 8cab1755406e4bfa8c517bf9c06d430e
              name: tx_errors
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 8f6dbd1651324ef284c100859a6d334b
              name: tx_bits
              type: DEPENDENT
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 57126ea8d9e24f29bd44499e92443a48
              name: high_speed
              type: DEPENDENT
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n`, then the speed of the interface is somewhere in the range of `n-500,000` to `n+499,999`.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 32253d50b3d741f693cbfbd329054152
              name: operational_status
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: a2a3ef0535ce4227b94cbf3bff88729d
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: interface_down
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for "eternal off" interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: description
                      value: '{#IFALIAS}'
                    - tag: interface
                      value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: db74c6913d1f49e7901ef7982839c3d3
              expression: |
                (avg(/template_linux_by_snmp/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/template_linux_by_snmp/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/template_linux_by_snmp/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/template_linux_by_snmp/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/template_linux_by_snmp/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/template_linux_by_snmp/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/template_linux_by_snmp/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/template_linux_by_snmp/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/template_linux_by_snmp/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: high_bandwidth_usage
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: interface_down
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 5321af6f7c034404a91ae86b85e9a6a9
              expression: |
                min(/template_linux_by_snmp/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/template_linux_by_snmp/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/template_linux_by_snmp/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/template_linux_by_snmp/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: high_error_rate
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: interface_down
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/template_linux_by_snmp/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          master_item:
            key: net.if.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFADMINSTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IFTYPE}'
                - 1.3.6.1.2.1.2.2.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 339d90306bb3440b99cc10eca2d69c95
          name: 'EtherLike-MIB Discovery'
          type: DEPENDENT
          key: net.if.duplex.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFOPERSTATUS}'
                value: '1'
                formulaid: A
              - macro: '{#SNMPVALUE}'
                value: (2|3)
                formulaid: B
              - macro: '{#SNMPVALUE}'
                operator: EXISTS
                formulaid: C
          description: 'Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with `up(1)` Operational Status are discovered.'
          item_prototypes:
            - uuid: c55ba03ed6f24f2fa2e715c00ff29d05
              name: duplex_status
              type: DEPENDENT
              key: 'net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: EtherLike-MIB
                The current mode of operation of the MAC entity. `unknown` indicates that the current duplex mode could not be determined.
                Management control of the duplex mode is accomplished through the MAU MIB. When an interface does not support autonegotiation or when autonegotiation is not enabled, the duplex mode is controlled using `ifMauDefaultType`. When autonegotiation is supported and enabled, duplex mode is controlled using `ifMauAutoNegAdvertisedBits`. In either case, the currently operating duplex mode in reflected both in this object and in `ifMauType`.
                Note that this object provides redundant information with `ifMauType`. Normally, redundant objects are discouraged. However, in this instance, it allows a management application to determine the duplex status of an interface without having to know every possible value of `ifMauType`. This was felt to be sufficiently valuable to justify the redundancy.
                Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.
              valuemap:
                name: 'EtherLike-MIB::dot3StatsDuplexStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.duplex.walk
              tags:
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 219120bf338342fe8fcbaba7f302c394
                  expression: 'last(/template_linux_by_snmp/net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}])=2'
                  name: interface_half_duplex
                  priority: WARNING
                  description: 'Please check autonegotiation settings and cabling.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
          master_item:
            key: net.if.duplex.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.2.1.10.7.2.1.19
                - '0'
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: cfd0ac36bcdb455497109da57d2f425a
          name: 'Block devices discovery'
          type: DEPENDENT
          key: 'vfs.dev.discovery[snmp]'
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: A
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable)'
          item_prototypes:
            - uuid: 0d2255c725f14a5c9229e7a520463a02
              name: disk_read_rate
              type: DEPENDENT
              key: 'vfs.dev.read.rate[diskIOReads.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '!r/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of read accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: d648b3f7ab974e05a4fae67cbb865db8
              name: disk_utilization
              type: DEPENDENT
              key: 'vfs.dev.util[diskIOLA1.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '%'
              description: |
                MIB: UCD-DISKIO-MIB
                The 1 minute average load of disk (%)
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.9.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 62578743d50d4acabecd050fe0196ccb
              name: disk_write_rate
              type: DEPENDENT
              key: 'vfs.dev.write.rate[diskIOWrites.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: '0'
              units: '!w/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of write accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: disk
                  value: '{#DEVNAME}'
          master_item:
            key: vfs.dev.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#DEVNAME}'
                - 1.3.6.1.4.1.2021.13.15.1.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: aec501bf94b243e8b7fa8b6c7b0f876a
          name: 'Mounted filesystem discovery'
          type: DEPENDENT
          key: 'vfs.fs.discovery[snmp]'
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSDEVICE}'
                value: '{$VFS.FS.FSDEVICE.MATCHES}'
                formulaid: A
              - macro: '{#FSDEVICE}'
                value: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: C
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          description: 'UCD-SNMP-MIB::dskEntry table discovery with storage filter'
          item_prototypes:
            - uuid: 160b982ad5264781b333ace8e54a27d4
              name: inodes_freee
              type: DEPENDENT
              key: 'vfs.fs.inode.pfree[{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Free metadata space expressed as percentage.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var obj = JSON.parse(value);
                      var dskPercentNode = obj['dskPercentNode'];
                      
                      return (100 - dskPercentNode);
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                - uuid: bbc5a4f82bb44ffba4198d7d72d9fa8f
                  expression: 'min(/template_linux_by_snmp/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  name: high_inode_utilization
                  event_name: 'FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Disk writing may fail if index nodes are exhausted, leading to error messages like "No space left on device" or "Disk is full", despite available free space.'
                  tags:
                    - tag: filesystem
                      value: '{#FSNAME}'
            - uuid: f8de1a6d83684945b7beccf785d24c4b
              name: filesystem_space_utilization
              type: DEPENDENT
              key: 'vfs.fs.pused[{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                UCD-SNMP-MIB::dskEntry
                Space utilization is calculated as the percentage of currently used space compared to the maximum available space.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var portionHigh = 4294967296;
                      var obj = JSON.parse(value);
                      var dskAvailHigh = obj['dskAvailHigh'],
                      	dskAvailLow = obj['dskAvailLow'];
                      var dskUsedHigh = obj['dskUsedHigh'],
                      	dskUsedLow = obj['dskUsedLow'];
                      
                      var available = (dskAvailHigh * portionHigh + dskAvailLow) * 1024;
                      var used = (dskUsedHigh * portionHigh + dskUsedLow) * 1024;
                      
                      if ((available + used) <= 0) {
                      	return 0;
                      } else {
                      	return (100 * used / (used + available));
                      }
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                - uuid: 9e6866ab2a6b45e5ba82ce38cec1e5dc
                  expression: 'min(/template_linux_by_snmp/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}'
                  name: high_disk_utilization
                  event_name: 'FS [{#FSNAME}]: Space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%, total {{?last(//vfs.fs.total[dskTotal.{#SNMPINDEX}])/1024/1024/1024}.fmtnum(1)}GB)'
                  opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
                  priority: AVERAGE
                  description: |
                    The volume's space usage exceeds the '{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%' limit;
                    The trigger expression is based on the current used and maximum available spaces.
                    Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
                  manual_close: 'YES'
                  tags:
                    - tag: filesystem
                      value: '{#FSNAME}'
            - uuid: 570b5c5299b44e22be0bb47ba05ea829
              name: filesystem_space_total
              type: DEPENDENT
              key: 'vfs.fs.total[dskTotal.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: B
              description: |
                MIB: UCD-SNMP-MIB
                Total storage is calculated from two portions:
                  dskTotalHigh
                  dskTotalLow
                Together they compose 64-bit number.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var portionHigh = 4294967296;
                      var obj = JSON.parse(value);
                      var dskTotalHigh = obj['dskTotalHigh'],
                      	dskTotalLow = obj['dskTotalLow'];
                      
                      return (dskTotalHigh * portionHigh + dskTotalLow) * 1024;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 4bd92bb3bddd43f5b9456c823ca25f8b
              name: filesystem_space_used
              type: DEPENDENT
              key: 'vfs.fs.used[dskUsed.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: B
              description: |
                MIB: UCD-SNMP-MIB
                Used storage is calculated from two portions:
                  dskUsedHigh
                  dskUsedLow
                Together they compose 64-bit number.
                Reserverd space is not counted in.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var portionHigh = 4294967296;
                      var obj = JSON.parse(value);
                      var dskUsedHigh = obj['dskUsedHigh'],
                      	dskUsedLow = obj['dskUsedLow'];
                      
                      return (dskUsedHigh * portionHigh + dskUsedLow) * 1024;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 13c857fb8dbc41ffb309736c01310d50
              name: get_file_system_data
              type: DEPENDENT
              key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              delay: '0'
              history: 1h
              value_type: TEXT
              trends: '0'
              description: |
                MIB: UCD-SNMP-MIB
                Intermediate data for subsequent processing.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var data = JSON.parse(value);
                      
                      result = data.filter(function(obj) {
                      	return obj["{\#SNMPINDEX}"] === "{#SNMPINDEX}";
                      })[0];
                      
                      return JSON.stringify(result);
              master_item:
                key: vfs.fs.walk
              tags:
                - tag: filesystem
                  value: '{#FSNAME}'
          master_item:
            key: vfs.fs.walk
          lld_macro_paths:
            - lld_macro: '{#FSDEVICE}'
              path: $.dskDevice
            - lld_macro: '{#FSNAME}'
              path: $.dskPath
            - lld_macro: '{#SNMPINDEX}'
              path: $.index
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var filesystems = JSON.parse(value);
                  
                  result = filesystems.map(function (filesystem) {
                  	return {
                  		'dskPath': filesystem.dskPath,
                  		'dskDevice': filesystem.dskDevice,
                  		'index': filesystem['{#SNMPINDEX}']
                  	};
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
          description: 'Critical threshold of CPU utilization expressed in %.'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Warning threshold of error packet rate. Can be used with interface name as context.'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the interface utilization trigger.'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Link status trigger will be fired only for interfaces where the context macro equals "1".'
        - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '1.5'
          description: 'Load per CPU considered sustainable. Tune if needed.'
        - macro: '{$MEMORY.AVAILABLE.MIN}'
          value: 20M
          description: 'Used as a threshold in the available memory trigger.'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the memory utilization trigger.'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore `down(2)` administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0 bridge` by default.'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore `notPresent(6)`'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
        - macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '50'
          description: 'The warning threshold of the minimum free swap.'
        - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: .+
          description: 'Used in block device discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: '^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)'
          description: 'Used in block device discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSDEVICE.MATCHES}'
          value: .+
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
          value: '.*(tmpfs|shm)$'
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/run|/proc|.+/shm$)
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
          value: '10'
          description: 'The critical threshold of the filesystem metadata utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
          description: 'The critical threshold of the filesystem utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
          description: 'The warning threshold of the filesystem utilization.'
      valuemaps:
        - uuid: 806609ee65ed421c9d20c662c98f1757
          name: 'EtherLike-MIB::dot3StatsDuplexStatus'
          mappings:
            - value: '1'
              newvalue: unknown
            - value: '2'
              newvalue: halfDuplex
            - value: '3'
              newvalue: fullDuplex
        - uuid: d6fc9eec129c49389b0ea39180106c36
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 051cbee8a5234af79d8de0d958df2bbe
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 5a3d06c4c7f04e3481350b6a4a8df9a5
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 6e48bf5b5b6b49f8b3137cc2dc73225e
      expression: 'max(/template_linux_by_snmp/system.swap.pfree[snmp],5m)<{$SWAP.PFREE.MIN.WARN} and last(/template_linux_by_snmp/system.swap.total[memTotalSwap.0])>0'
      name: high_swap_space_utilization
      event_name: 'High swap space usage (less than {$SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'If there is no swap configured, this trigger is ignored.'
      dependencies:
        - name: high_memory_utilization
          expression: 'min(/template_linux_by_snmp/vm.memory.util[snmp],5m)>{$MEMORY.UTIL.MAX}'
    - uuid: ad650dee58cc4db9b91098d88ddf60fc
      expression: |
        min(/template_linux_by_snmp/system.cpu.load.avg1[laLoad.1],5m)/last(/template_linux_by_snmp/system.cpu.num[snmp])>{$LOAD_AVG_PER_CPU.MAX.WARN}
        and last(/template_linux_by_snmp/system.cpu.load.avg5[laLoad.2])>0
        and last(/template_linux_by_snmp/system.cpu.load.avg15[laLoad.3])>0
      name: high_system_load_average
      event_name: 'Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)'
      opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'The load average per CPU is too high. The system may be slow to respond.'
