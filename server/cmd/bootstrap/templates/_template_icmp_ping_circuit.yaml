zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 1877cc163d5b46e1a8121d91b1dbe38e
      name: Templates/narvis
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 1125559d66b94c309a7cc8966092d542
      template: template_icmp_ping_circuit
      name: template_icmp_ping_circuit
      description: |
        Template Net ICMP Ping
        
        Generated by official Zabbix template tool "Templator"
      groups:
        - name: Templates/narvis
        - name: 'Templates/Network devices'
      items:
        - uuid: 34f58a6e6985450bbf961149d8d34d4d
          name: circuit_icmp_ping
          type: SIMPLE
          key: icmpping
          delay: 30s
          valuemap:
            name: 'Service state'
          triggers:
            - uuid: cd597f6468bf4954aa2b990b92563dab
              expression: 'max(/template_icmp_ping_circuit/icmpping,#3)=0'
              name: NodePingTimeout
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
        - uuid: f59a5bdc2a4d48c48f383279653e8759
          name: circuit_icmp_loss
          type: SIMPLE
          key: icmppingloss
          delay: 30s
          value_type: FLOAT
          units: '%'
          triggers:
            - uuid: 5b1121f940794683a123005aa84f730b
              expression: 'min(/template_icmp_ping_circuit/icmppingloss,150s)>{$ICMP_LOSS_WARN} and min(/template_icmp_ping_circuit/icmppingloss,150s)<100'
              name: HighICMPPacketLoss
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: NodePingTimeout
                  expression: 'max(/template_icmp_ping_circuit/icmpping,#3)=0'
        - uuid: 494705f4147641cf9645fcbae89a3c40
          name: circuit_icmp_response_time
          type: SIMPLE
          key: icmppingsec
          delay: 30s
          value_type: FLOAT
          units: s
          triggers:
            - uuid: 14e41acccfdd45d49f4703fb46bf5cba
              expression: 'avg(/template_icmp_ping_circuit/icmppingsec,150s)>{$ICMP_RESPONSE_TIME_WARN}'
              name: HighICMPLatency
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: HighICMPPacketLoss
                  expression: 'min(/template_icmp_ping_circuit/icmppingloss,150s)>{$ICMP_LOSS_WARN} and min(/template_icmp_ping_circuit/icmppingloss,150s)<100'
                - name: NodePingTimeout
                  expression: 'max(/template_icmp_ping_circuit/icmpping,#3)=0'
      macros:
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
      valuemaps:
        - uuid: f6ba54ba6afe4a768a7ee624766321cf
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
