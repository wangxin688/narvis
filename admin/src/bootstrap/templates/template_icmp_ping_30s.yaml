zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 1877cc163d5b46e1a8121d91b1dbe38e
      name: Templates/narvis
  templates:
    - uuid: 967cc92529c44108a82edc3d2534453c
      template: 'icmp ping 30s'
      name: 'icmp ping 30s'
      description: 'template icmp ping 30s'
      groups:
        - name: Templates/narvis
      items:
        - uuid: f93a90d9994b49e6b14e99fbe79fa716
          name: icmp_ping
          type: SIMPLE
          key: icmpping
          delay: 30s
          history: 7d
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 5bbd6cf41a2041fab8a40051333e1689
              expression: 'max(/icmp ping 30s/icmpping,#3)=0'
              name: unavailable_by_icmp_ping
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: b782008cd1b44662b62a14cb1f3af5a6
          name: icmp_packet_loss
          type: SIMPLE
          key: icmppingloss
          delay: 30s
          history: 7d
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 0c3e165ece0541d9bcba1b8448383e4d
              expression: 'min(/icmp ping 30s/icmppingloss,150s)>{$ICMP_LOSS_WARN} and min(/icmp ping 30s/icmppingloss, 150s)<100'
              name: high_icmp_ping_loss
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: unavailable_by_icmp_ping
                  expression: 'max(/icmp ping 30s/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: e5549e6187374ed1b7e7b14f08e28812
          name: icmp_response_time
          type: SIMPLE
          key: icmppingsec
          delay: 30s
          history: 7d
          value_type: FLOAT
          units: s
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 9cc952a57e8f42de948d372db911cc3f
              expression: 'avg(/icmp ping 30s/icmppingsec,150s)>{$ICMP_RESPONSE_TIME_WARN}'
              name: high_icmp_response_time
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                - name: high_icmp_ping_loss
                  expression: 'min(/icmp ping 30s/icmppingloss,150s)>{$ICMP_LOSS_WARN} and min(/icmp ping 30s/icmppingloss, 150s)<100'
                - name: unavailable_by_icmp_ping
                  expression: 'max(/icmp ping 30s/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
      tags:
        - tag: class
          value: network
        - tag: target
          value: icmp
      macros:
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.2'
      valuemaps:
        - uuid: d32b25cbf9f94c69ac4d25398ad3951e
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
